\chapter{Geometric re-expression of condition \Gthree}\label{chapter:geometry}

\section{Introduction}

As part of optimal transport theory, Ma-Trudinger-Wang \cite{MaTrudingerWang05} in 2005 gave sufficient conditions on a transportation cost to guarantee smoothness of the optimal transportation map, while Leoper \cite{Loeper09} showed these conditions are also necessary. In 2010, Kim-McCann \cite{KimMcCann10} expressed them via non-negativity of the sectional curvature of certain null-planes in a novel but natural pseudo-Riemannian geometry which was induced by the cost function on some product space.\medskip

In Chapter \ref{chapter:analytic_representation}, we show that \Gthree~is, in fact, a fourth order condition in the spirit of the Ma-Trudinger-Wang condition. Inspired by Kim-McCann \cite{KimMcCann10}, we will show in this chapter a geometric representation of condition \Gthree, which is non-negativity of the sectional curvature in a pseudo-Riemannian geometry induced by the utility $\barG$, up to the additional variable, on the product space $X\times \R \times Y \times \R$.\medskip

\section{Context}\label{section:geometric_setting}

In this section, we will define the pseudo-Riemannian metric $g$ and calculate the Christoffel symbols $\Gamma$ and the curvature tensor $R$. \medskip

Let $\barG (x,w, y,z) = w G(x,y,z)$, $\barx = (x,w)$, $\bary = (y,z)$, and $\delta(\barx, \bary, \barx_{0}, \bary_{0}) = -\barG (\barx, \bary) -\barG(\barx_0, \bary_0) +\barG(\barx, \bary_0) + \barG(\barx_0, \bary)$.\medskip

For some fixed $(\barx_0, \bary_0)$, one can view the $\delta$ defined above as a function of variable $\Xi =(\barx, \bary)$ on the space $M = X \times \R \times Y \times \R$, with the following first order derivatives.
\begin{equation}
	\nabla_i \delta (\barx, \bary, \barx_0, \bary_0) = \begin{cases}
	-\barG_{i,}(\barx, \bary) + \barG_{i,}(\barx, \bary_0) , & i\le n+1\\
	-\barG_{,\bar{i}}(\barx, \bary) + \barG_{,\bar{i}}(\barx_0, \bary), & i> n+1 \\
	\end{cases}
\end{equation}
Here we adopt this notation $\bar{i}:= i-(n+1)$ for $n+1 <i\le 2(n+1)$. As a notation convention, we use a comma to separate subscripts of $\barG$, which correspond to the derivatives with respect to the variables $\barx$ in spaces $X \times \R$ (before comma) and $\bary$ in $Y \times \R$ (after comma), respectively.\medskip

If $G\in C^2$, for each fixed $(\barx_0, \bary_0)$, since the first derivative of $\delta$ vanishes at $(\barx, \bary) = (\barx_0, \bary_0)$,  
the second order derivatives of $\delta$ at $\Xi_0 = (\barx_0, \bary_0)$ is well-defined and can be written as follows.
\begin{equation}\label{pseudo_metric}
	\nabla_{ij} \delta (\barx, \bary, \barx_0, \bary_0){\big|}_{(\barx, \bary) = (\barx_0, \bary_0)}
	=\begin{cases}
	-\barG_{i,\bar{j}}(\barx_0, \bary_0),& i\le n+1 < j\\
	-\barG_{j, \bar{i}}(\barx_0, \bary_0),& i>n+1 \ge j\\
	0,& \text{ otherwise}
	\end{cases}
\end{equation}  

Let $T_{\Xi_0}M$ denote the tangent space to $M$ at ${\Xi_0}$. Define the pseudo-Riemannian metric $ g_{\Xi_0}: T_{\Xi_0}M\times T_{\Xi_0}M \rightarrow \R$ at $\Xi_0$ on $M$ to be the above $2(n+1) \times 2(n+1)$ symmetric matrix.\medskip

One can calculate the Christoffel symbols using the following formula with Einstein summation convention where $g^{ml}$ is the inverse matrix of $g$:
\begin{equation}\label{Gamma}
	\Gamma_{ij}^m = \frac{1}{2} g^{ml}\left(\frac{\partial g_{il}}{\partial \Xi_j} + \frac{\partial g_{jl}}{\partial \Xi_i} - \frac{\partial g_{ij}}{\partial \Xi_l}\right).
\end{equation}

Here is a calculation of each component:
\begin{equation}
g_{il;j}:=	\frac{\partial g_{il}}{\partial \Xi_j} = \begin{cases}
-	\barG_{i, \bar{j}\bar{l}}, & i \le n+1 < j, l; \\
-	\barG_{ij, \bar{l}}, & i,j \le n+1 <l; \\
-	\barG_{l, \bar{i}\bar{j}}, & l \le n+1 <i,j; \\
-	\barG_{jl, \bar{i}}, & j,l \le  n+1<i ; \\
	0 & \text{ otherwise}.
	\end{cases}
\end{equation}

Similarly, one has
\begin{equation}
g_{lj;i}:=\frac{\partial g_{lj}}{\partial \Xi_i} = \begin{cases}
-\barG_{j, \bar{i}\bar{l}}, & j \le n+1 < i, l; \\
-\barG_{ij, \bar{l}}, & i,j \le n+1 <l; \\
-\barG_{l, \bar{i}\bar{j}}, & l \le n+1 < i,j; \\
-\barG_{il, \bar{j}}, &  i,l \le n+1 <j ; \\
0 & \text{ otherwise};
\end{cases}
\end{equation}

\begin{equation}
g_{ij;l}:=\frac{\partial g_{ij}}{\partial \Xi_l} = \begin{cases}
-\barG_{i, \bar{j}\bar{l}}, & i \le n+1 < j, l; \\
-\barG_{il, \bar{j}}, & i,l \le n+1 <j; \\
-\barG_{j, \bar{i}\bar{l}}, & j \le n+1 < i, l ; \\
-\barG_{jl, \bar{i}}, &  j,l \le n+1 < i; \\
0 & \text{ otherwise}.
\end{cases}
\end{equation}


Therefore, putting together these three terms, one has
\begin{equation}
	\frac{\partial g_{il}}{\partial \Xi_j} +\frac{\partial g_{lj}}{\partial \Xi_i}
	-\frac{\partial g_{ij}}{\partial \Xi_l}=
	\begin{cases}
-	2\barG_{ij, \bar{l}}, & i,j \le n+1 < l; \\
-	2\barG_{l, \bar{i}\bar{j}}, & i,j >n+1 \ge l; \\
	0, & \text{otherwise}.
	\end{cases}
\end{equation}

Denote $\barG^{m, \bar{l}}$ as the inverse matrix of $\barG_{k, \bar{l}}$. Since $g^{ml} g_{lk} = g_{k}^{m}$, one has

\begin{equation}
	g^{ml} = \begin{cases}
-	\barG^{m, \bar{l}}, & m \le n+1< l; \\
-	\barG^{l, \bar{m}}, & l \le n+1< m; \\
	0, & \text{ otherwise}.
	\end{cases}
\end{equation}

Therefore, the Christoffel symbols could be represented as follows.
\begin{flalign}\label{Gamma_2}
\begin{split}
	\Gamma_{ij}^{m} &= \frac{1}{2} g^{ml}(g_{il;j}+g_{lj;i}-g_{ij;l})\\
	&=\begin{cases}
	\barG^{m, \bar{l}} \barG_{ij, \bar{l}}, & i,j,m \le n+1 <l; \\
	\barG^{l, \bar{m}} \barG_{l, \bar{i}\bar{j}}, & i,j,m > n+1 \ge l; \\
	0, & \text{ otherwise}.
	\end{cases}
\end{split}	
\end{flalign}

Then one can calculate the pseudo-Riemannian curvature tensor $R$.
\begin{flalign}
	R_{ijkl} &= g_{im}R^{m}_{jkl}\\
		  &= -g_{im}\left[\frac{\partial }{\partial \Xi_l} \Gamma_{jk}^{m} -\frac{\partial }{\partial \Xi_k} \Gamma_{jl}^m + \Gamma_{l\alpha}^{m}\Gamma_{jk}^{\alpha} - \Gamma_{k\alpha}^{m} \Gamma_{jl}^{\alpha} \right]\\
		  &= \begin{cases}\label{curvature_tensor}
		  -\barG_{il,\alpha} \barG^{\beta, \alpha} \barG_{\beta, \bar{j}\bar{k}} + \barG_{il, \bar{j}\bar{k}}, & i,l \le n+1 <k,j; \\
		  \barG_{ik,\alpha} \barG^{\beta, \alpha} \barG_{\beta, \bar{j}\bar{l}} - \barG_{ik, \bar{j}\bar{l}}, & i,k \le n+1 <l,j; \\
		  -\barG_{jk,\alpha} \barG^{\beta, \alpha} \barG_{\beta, \bar{i}\bar{l}} + \barG_{jk, \bar{i}\bar{l}}, & j,k \le n+1 <l,i; \\
		  \barG_{jl,\alpha} \barG^{\beta, \alpha} \barG_{\beta, \bar{i}\bar{k}} - \barG_{jl, \bar{i}\bar{k}}, & j,l \le n+1 <k,i; \\
		  0, & \text{ otherwise}.
		  \end{cases}
\end{flalign}






\section{G-segments are geodesics}


\begin{definition}[G-segment with the notion of additional variable]\label{DefGsegment}
		For each $\barx_0 =(x_0,  w_0)\in X \times \R$, $\bary_0, \bary_1 \in cl( Y \times Z)$ with $w_0 \ne 0 %\color{red}w_0 >0?
		$, 
		define $\bary_t\in cl( Y \times Z)$ such that the following equation 
		\begin{flalign}\label{$G$-segment2}
		\begin{split}
		D_{\barx}\barG(\barx_0,\bary_t) = (1-t)D_{\barx}\barG(\barx_0, \bary_0) + t D_{\barx}\barG(\barx_0, \bary_1)
		\end{split}
		\end{flalign}
		holds for each $t\in [0,1].$
		By conditions \Gone \ and \Gtwo , $\bary_t$ is uniquely determined by (\ref{$G$-segment2}). 
		We call $t \in [0,1] \longmapsto (\barx_0,\bary_t)$ the  $G$-segment connecting $(\barx_0, \bary_0)$ and $(\barx_0, \bary_1)$ on $M$.
\end{definition}

For any continuous, piecewise continuously differentiable curves $\gamma: [0,1] \longrightarrow M$, let $E(\cdot)$ denote the energy functional:
\begin{flalign}
	E(\gamma) = \frac{1}{2} \int_{0}^1 g_{\gamma(t)}(\dot{\gamma}(t), \dot{\gamma}(t)) dt.
\end{flalign}

Then the Euler-Lagrange equations of motion for the functional $E$ are given by 
\begin{flalign}\label{geodesicEqn}
	\frac{d^2 \Xi^{m}}{dt^2} + \Gamma_{ij}^{m} \frac{d\Xi^{i}}{dt}\frac{d\Xi^{j}}{dt} = 0,
\end{flalign}
where $\Gamma_{ij}^{m}$ is the Christoffel symbol define in \eqref{Gamma}. The above equality \eqref{geodesicEqn} is the so-called geodesic equation.

\begin{proposition}[G-segments are geodesics]
	Assume \Gone\ and \Gtwo. For any G-segment $t\in [0,1] \longmapsto (\barx_0, \bary_t)$, defined in Definition \ref{DefGsegment}, connecting $(\barx_0, \bary_0)$ and $(\barx_0, \bary_1)$ on $M$, it satisfies the geodesic equation \eqref{geodesicEqn}.
\end{proposition}

\begin{proof}
	Since G-segment $t\in [0,1] \longmapsto (\barx_0, \bary_t)$ satisfies \eqref{$G$-segment2}, the following equations hold:
	\begin{flalign}
	\label{$G$-segment3.1}	0 =\ & \partial_{t}^2 D_{\barx}\barG(\barx_0,\bary_t)\\
	\label{$G$-segment3.2}	=\ & D_{\barx^{k}\bary^{m}}\barG\cdot\ddot{\bary}_{t}^m +  D_{\barx^{k}\bary^{i}\bary^{j}}\barG\cdot\dot{\bary}_{t}^{i}\ \dot{\bary}_{t}^{j}.
	\end{flalign}
	This implies 
	\begin{flalign}
		\ddot{\bary}_{t}^m + [(D_{\barx^{k}\bary^{m}}\barG)^{-1}]^{k,m} \cdot D_{\barx^{k}\bary^{i}\bary^{j}}\barG \cdot \dot{\bary}_{t}^{i}\ \dot{\bary}_{t}^{j} =0.
	\end{flalign}
	Rewrite the above equation in terms of variable $\Xi$, then one has
	\begin{flalign}
		\ddot{\Xi}_t^m + \barG^{k, \bar{m}} \cdot \barG_{k, \bar{i} \bar{j}} \cdot \dot{\Xi}_t^{i}\ \dot{\Xi}_{t}^{j} = 0, \text{ where } k \le n+1 < i,j,m.
	\end{flalign}
	Combining with \eqref{Gamma_2}, this implies the geodesic equation \eqref{geodesicEqn}.
\end{proof}

\section{Condition \Gthree\ is a non-negative sectional curvature condition}

Recall that in concavity arguments in Chapter \ref{chapter:convexity}, condition \Gthree\ plays the most important role. In Section \ref{section:4thorder}, we introduced the fourth-order differential re-expression of condition \Gthree. One may also wonder what the geometric meaning of the \Gthree\ condition is. In this section, we are going to show the geometric re-expression of condition \Gthree.

\begin{itemize}
	\item[\Gthree] For any $\barx=(x, w)$ with $w>0$, assume $\partial_t^2 \barG(\barx, \bary_t) \ge 0$, whenever there exists $\barx_0 =(x_0, 1)$ such that $\partial_t^2 D_{\barx}\barG(\barx_0, \bary_t) = 0$. 
\end{itemize}

For the pseudo-Riemannian metric tensor $g$ defined in \eqref{pseudo_metric} and any two tangent vectors $P, Q\in T_{\Xi_0}M$, define the unnormalized sectional curvature at the point $\Xi_0 \in M$ as
\begin{flalign}
	\sec_{\Xi_0}^{(M, g)}P \wedge Q 
	:= R_{ijkl}(\Xi_{0})\cdot P^{i}\cdot P^{l} \cdot Q^{j} \cdot Q^{k},
\end{flalign}
where $R$ is the curvature tensor shown in \eqref{curvature_tensor}.
\medskip


The following theorem describes equivalent expressions of the \Gthree\ condition. Part $\mathrm{(i)}$ and $\mathrm{(iii)}$ are taken from Theorem \ref{theorem:4thorder}. While keeping the ordering number of statements from Chapter \ref{chapter:analytic_representation} (Theorem \ref{theorem:4thorder} and Corollary \ref{FourthOrder4}),  part $\mathrm{(v)}$ is a variation of $\mathrm{(iii)}$ by rewriting \Gthree\ condition with the notion of the additional variable, and part $\mathrm{(vi)}$ is the non-negative sectional curvature condition on the manifold $M$ defined in Section \ref{section:geometric_setting}.


\begin{theorem}\label{prop:4thorder2}
	Assume \Gzero-\Gtwo\ and \Gfour-\Geight. If, in addition, $G\in C^4(cl(X\times Y \times Z)
	)$,  then the following statements are equivalent:
	\begin{enumerate}[(i)]
		\item \Gthree.
				
		\item[(iii)] For any given curve $x_s\in X$ connecting $x_0$ and $x_1$,  any $(y_0, z_0),  (y_1, z_1) \in cl( Y \times Z) $, we have 
		\begin{equation}
		\frac{\partial^2}{\partial s^2 }\Biggl(\frac{1}{G_z(x_s, y_t, z_t)}\frac{\partial^2}{\partial t^2} G(x_s,y_t,z_t) \Biggr)\Bigg|_{s=s_0}\le 0,
		\end{equation}
		whenever $t\in [0,1] \longmapsto (G_x, G)(x_{s_0}, y_t, z_t)$  forms an affinely parametrized line segment for some $s_0\in [0,1]$.
		
	\item[(v)] Let $s\in [0,1] \longmapsto w_s \in (0, \infty)$
	, for any given curve $x_s\in X$ connecting $x_0$ and $x_1$, any $\bary_0,  \bary_1 \in cl( Y \times Z) $, we have 
	\begin{equation}\label{barG-4thorder}
	\frac{\partial^4}{\partial s^2 \partial t^2} \Bigg|_{s=s_0} \barG(\barx_s,\bary_t)  \ge 0,
	\end{equation}
	whenever $t\in [0,1] \longmapsto (\barx_{s_0}, \bary_t)$  forms a G-segment for some $s_0\in [0,1]$.
	
%	\item Let $s\in [0,1] \longmapsto w_s \in (0, \infty)$
%		, for any given curve $x_s\in X$ connecting $x_0$ and $x_1$, any $\bary_0,  \bary_1 \in cl( Y \times Z) $, we have 
%		\begin{equation}\label{Curvature_sectional}
%		\sec_{(\barx_{s_0}, \bary_{t})}^{(M, g)}(p\oplus 0)\wedge (0\oplus q) \ge 0,
%		\end{equation}
%		whenever $t\in [0,1] \longmapsto (\barx_{s_0}, \bary_t)$  forms a G-segment for some $s_0\in [0,1]$, where $p=\dot{\barx}_{s_0}$ and $q = \dot{\bary}_t$.

	
	\item[(vi)] For any vectors $P = p \oplus 0$, $Q = 0 \oplus q \in \R^{2n+2}$, where $p, q, 0 \in \R^{n+1}$ and $\oplus$ represents the direct sum, and $\Xi_{\nul} = (x_{\nul}, w_{\nul}, \bary_{\nul}) \in M$ with $w_{\nul} \in (0, \infty)$, the sectional curvature satisfies
		\begin{equation}\label{Curvature_sectional2}
		\sec_{\Xi_{\nul}}^{(M, g)} P \wedge Q \ge 0.
		\end{equation}
	\end{enumerate} 
\end{theorem}

\begin{proof}
	$\mathrm{(i)}$ and $\mathrm{(iii)}$ are equivalent from Theorem \ref{theorem:4thorder}. Only need to show the equivalences of $\mathrm{(iii)}$ and $\mathrm{(v)}$, $\mathrm{(v)}$ and $\mathrm{(vi)}$.
	
	$\mathrm{(iii)}\Rightarrow \mathrm{(v)}.$ Let $x_0$, $x_1$ be any two points on $X$, $(y_0, z_0)$,  $(y_1, z_1)$ be any two points on $cl( Y \times Z)$, $w_s$ be any curve on $(0, \infty)$, $x_s\in X$ be any curve connecting $x_0$ and $x_1$, and $(y_t, z_t) \in cl(Y\times Z)$ be any curve connecting $(y_0, z_0)$ and $(y_1, z_1)$. Suppose there exists $s_0\in [0,1]$, such that $t\in [0,1] \longmapsto (\barx_{s_0}, \bary_t)$  forms a G-segment. Then from \eqref{$G$-segment3.1}, we know $t\in [0,1] \longmapsto (G_x, G)(x_{s_0}, y_t, z_t)$ forms an affinely parametrized line segment, i.e., 
	\begin{flalign}
	\label{$G$-segment4.1}	0 &\ = \frac{\partial^2}{\partial t^2} G_x(x_{s_0}, y_t, z_t),\\
	\label{$G$-segment4.2}	0 &\ = \frac{\partial^2}{\partial t^2} G(x_{s_0}, y_t, z_t).
	\end{flalign}
	Therefore, one has
	\begin{flalign}
		0\ge &\	\frac{\partial^2}{\partial s^2 }\Biggl(\frac{1}{G_z(x_s, y_t, z_t)}\frac{\partial^2}{\partial t^2} G(x_s,y_t,z_t) \Biggr)\Bigg|_{s=s_0}\\
		= &\ \frac{1}{G_z(x_{s_0}, y_t, z_t)}  \frac{\partial^4}{\partial s^2 \partial t^2} \Bigg|_{s=s_0} G(x_s,y_t,z_t) + \frac{\partial^2}{\partial s^2} \Bigg|_{s=s_0} \frac{1}{G_z}(x_s, y_t, z_t) \cdot \frac{\partial^2}{\partial t^2} G(x_{s_0}, y_t, z_t)\\
		&\ +2 \frac{\partial }{\partial s}\Bigg|_{s=s_0}\frac{1}{G_z(x_s, y_t, z_t)} \cdot \frac{\partial^2}{ \partial t^2}  G_x(x_{s_0}, y_t, z_t)\cdot \dot{x}_s\Bigg|_{s=s_0}\\
		= &\ \frac{1}{G_z(x_{s_0}, y_t, z_t)}  \frac{\partial^4}{\partial s^2 \partial t^2} \Bigg|_{s=s_0} G(x_s,y_t,z_t).
	\end{flalign}
	Notice that $G_z <0$ because of condition \Gfour. Thus, the above inequality is equivalent to 
	\begin{flalign}\label{4thorderEqn2}
		\frac{\partial^4}{\partial s^2 \partial t^2} \Bigg|_{s=s_0} G(x_s,y_t,z_t) \ge 0.
	\end{flalign}
	On the other hand, for the same curves described above, since $\barG(\barx_s, \bary_t) = \barG(x_s, w_s, y_t, z_t) = w_s G(x_s,y_t,z_t)$, applying \eqref{$G$-segment4.1} and \eqref{$G$-segment4.2}, one has
	\begin{flalign}
		\frac{\partial}{\partial s} \barG(\barx_s, \bary_t) &\ = \dot{w}_s G(x_s, y_t, z_t) + w_s \frac{\partial}{\partial s} G(x_s, y_t, z_t)\\
		\frac{\partial^2}{\partial s^2} \barG(\barx_s, \bary_t) &\ = \ddot{w}_s G(x_s, y_t, z_t) + 2 \dot{w}_s \frac{\partial}{\partial s} G(x_s, y_t, z_t) + w_s \frac{\partial^2}{\partial s^2} G(x_s, y_t, z_t)\\
		\frac{\partial^4}{\partial s^2 \partial t^2} \Bigg|_{s=s_0} \barG(\barx_s, \bary_t) &\ = \ddot{w}_{s_0} \frac{\partial^2}{\partial t^2} G(x_{s_0}, y_t, z_t) + 2 \dot{w}_{s_0} \dot{x}_{s_0} \frac{\partial^2}{\partial t^2}  G_x(x_{s_0}, y_t, z_t) + w_{s_0} \frac{\partial^4}{\partial s^2 \partial t^2}\Bigg|_{s=s_0} G(x_s, y_t, z_t)\\
		&\ = w_{s_0} \frac{\partial^4}{\partial s^2 \partial t^2}\Bigg|_{s=s_0} G(x_s, y_t, z_t).
	\end{flalign}
	
	Since $w_{s_0}$ is positive, the equation \eqref{4thorderEqn2} is equivalent to 
	
	\begin{flalign}\label{4thorderEqn3}
	\frac{\partial^4}{\partial s^2 \partial t^2} \Bigg|_{s=s_0} \barG(\barx_s, \bary_t) \ge 0.
	\end{flalign}
	
	$\mathrm{(v)}\Rightarrow \mathrm{(iii)}.$ Let $x_0$, $x_1$ be any two points on $X$, $(y_0, z_0)$,  $(y_1, z_1)$ be any two points on $cl( Y \times Z)$,  $x_s\in X$ be any curve connecting $x_0$ and $x_1$, and $(y_t, z_t) \in cl(Y\times Z)$ be any curve connecting $(y_0, z_0)$ and $(y_1, z_1)$, satisfying that  $t\in [0,1] \longmapsto (G_x, G)(x_{s_0}, y_t, z_t)$ forms an affinely parametrized line segment. Let $w_s \equiv 1$, for all $s =\in [0,1]$. Then, by definition, $t\in [0,1] \longmapsto (\barx_{s_0}, \bary_t)$  forms a G-segment. From $\mathrm{(v)}$, one has
	\begin{flalign}
	\frac{\partial^4}{\partial s^2 \partial t^2} \Bigg|_{s=s_0} \barG(\barx_s,\bary_t)  \ge 0.
	\end{flalign}
	
	By the similar computations as in the first part and $G_z <0$ because of condition \Gfour, one has 
	\begin{flalign}
		\frac{\partial^2}{\partial s^2 }\Biggl(\frac{1}{G_z(x_s, y_t, z_t)}\frac{\partial^2}{\partial t^2} G(x_s,y_t,z_t) \Biggr)\Bigg|_{s=s_0}	= 	&\ 	\frac{1}{G_z(x_{s_0}, y_t, z_t)}  \frac{\partial^4}{\partial s^2 \partial t^2} \Bigg|_{s=s_0} G(x_s,y_t,z_t) \\
	=	&\ 
	\frac{1}{G_z(x_{s_0}, y_t, z_t)} \frac{\partial^4}{\partial s^2 \partial t^2} \Bigg|_{s=s_0} \barG(\barx_s,\bary_t) \le 0.
	\end{flalign}
	
	
	$\mathrm{(v)}\Rightarrow \mathrm{(vi)}.$ 
	Let $\barx_s$ be any curve on $ X \times (0, \infty)$ with $\barx_{s}|_{s=0} = (x_{\nul}, w_{\nul})$ and $\dot{\barx}_{s}|_{s=0} = p$, $\bary_t$ be any curve on $cl( Y \times Z)$, satisfying $\bary_t|_{t=0} = \bary_{\nul}$, $\dot{\bary}_t|_{t=0} = q$ and the following equation
	\begin{flalign}\label{$G$-segment4.3}
		\partial_t^2 D_{\barx}\barG(\barx_{0}, \bary_t) =0.
	\end{flalign}
	That is, the curve $t\in [0,1] \longmapsto (\barx_{0}, \bary_t)$  forms a G-segment. Thus by $\mathrm{(v)}$ we know 
	\begin{flalign}\label{4thorderEqn4}
			\frac{\partial^4}{\partial s^2 \partial t^2} \Bigg|_{s=0} \barG(\barx_s,\bary_t)  \ge 0.
	\end{flalign}
	On the other hand, from \eqref{$G$-segment4.3} we know
	\begin{flalign}
		 \barG_{i,j}(\barx_{0}, \bary_t) \cdot \ddot{\bary}_t^{j} + 
		 \barG_{i,kl} (\barx_{0}, \bary_t) \cdot \dot{\bary}_t^{k} \cdot \dot{\bary}_t^{l}=0.
	\end{flalign}
	
	This implies 
	\begin{flalign}
		 \ddot{\bary}_t^{j} = - 
		 \barG^{i,j}(\barx_{0}, \bary_t) \cdot \barG_{i,kl} (\barx_{0}, \bary_t) \cdot \dot{\bary}_t^{k} \cdot \dot{\bary}_t^{l}.
	\end{flalign}
	
	Thus
	
	\begin{flalign}
		&\frac{\partial^4}{\partial s^2 \partial t^2} \barG(\barx_s, \bary_t)\Bigg|_{s=0} \\
		=\ & \frac{\partial^2}{\partial t^2} [\barG_{i,}(\barx_s, \bary_t)\cdot \ddot{\barx}_s^{i} + \barG_{il,}(\barx_s, \bary_t)\cdot \dot{\barx}_s^{i}\cdot\dot{\barx}_s^{l}]\Bigg|_{s=0}\\
		=\ &  \frac{\partial^2}{\partial t^2} \barG_{il,}(\barx_{0}, \bary_t)\cdot \dot{\barx}_{0}^{i}\cdot\dot{\barx}_{0}^{l}\\
		=\ & \barG_{il,j}(\barx_{0}, \bary_t)\cdot \dot{\barx}_{0}^{i}\cdot\dot{\barx}_{0}^{l} \cdot \ddot{\bary}_t^{j} + \barG_{il,jk}(\barx_{0}, \bary_t)\cdot \dot{\barx}_{0}^{i}\cdot\dot{\barx}_{0}^{l} \cdot \dot{\bary}_t^{j} \cdot \dot{\bary}_t^{k}\\
	\label{4-tensor1}	=\ & [- \barG_{il,\alpha}(\barx_{0}, \bary_t)\cdot \barG^{\beta,\alpha}(\barx_{0}, \bary_t) \cdot \barG_{\beta,jk} (\barx_{0}, \bary_t) + \barG_{il,jk}(\barx_{0}, \bary_t)]\cdot \dot{\barx}_{0}^{i}\cdot\dot{\barx}_{0}^{l} \cdot\dot{\bary}_t^{j} \cdot \dot{\bary}_t^{k},
	\end{flalign} 
	where $i,l, j, k, \alpha, \beta = 1,2,..., n+1.$
	
	Denote $\Xi_{t} := (\barx_{0}, \bary_t)$. Since $P = \dot{\barx}_{0} \oplus 0$, one can rewrite \eqref{4-tensor1} as 
	\begin{flalign}
	&	\sum_{i,l =1}^{n+1}\sum_{j,k = n+2}^{2n+2} \sum_{\alpha, \beta = 1}^{n+1}
	[- \barG_{il,\alpha}(\Xi_{t})\cdot \barG^{\beta,\alpha}(\Xi_{t}) \cdot \barG_{\beta,\bar{j}\bar{k}} (\Xi_{t}) + \barG_{il,\bar{j}\bar{k}}(\Xi_{t})]\cdot P^{i}\cdot P^{l} \cdot\dot{\Xi}_t^{j} \cdot \dot{\Xi}_t^{k} \\
	= \ & \sum_{i,l =1}^{n+1}\sum_{j,k = n+2}^{2n+2} R_{ijkl}(\Xi_{t})\cdot P^{i}\cdot P^{l} \cdot\dot{\Xi}_t^{j} \cdot \dot{\Xi}_t^{k} \\
	= \ &  \sum_{i,l, j, k = 1}^{2n+2}
	R_{ijkl}(\Xi_{t})\cdot P^{i}\cdot P^{l} \cdot\dot{\Xi}_t^{j} \cdot \dot{\Xi}_t^{k} \\
	= \ & \sec_{\Xi_{t}}^{(M, g)}P \wedge \dot{\Xi}_t.
	\end{flalign}
	Therefore, equation \eqref{4thorderEqn4} implies 
	\begin{flalign}
		\sec_{\Xi_{t}}^{(M, g)}P \wedge \dot{\Xi}_t \ge 0.
	\end{flalign}
	In particular, for $t=0$, since $Q = \dot{\Xi}_0 \in \R^{2n+2}$, 
	\begin{flalign}
	\sec_{\Xi_{0}}^{(M, g)}P \wedge Q \ge 0.
	\end{flalign}
	
	
	$\mathrm{(vi)}\Rightarrow \mathrm{(v)}.$ Let $x_0$, $x_1$ be any two points on $X$, $(y_0, z_0)$,  $(y_1, z_1)$ be any two points on $cl( Y \times Z)$, $w_s$ be any curve on $(0, \infty)$, $x_s\in X$ be any curve connecting $x_0$ and $x_1$, and $(y_t, z_t) \in cl(Y\times Z)$ be any curve connecting $(y_0, z_0)$ and $(y_1, z_1)$. Suppose there exists $s_0\in [0,1]$, such that $t\in [0,1] \longmapsto (\barx_{s_0}, \bary_t)$  forms a G-segment. Then from \eqref{$G$-segment3.1}, we know 
	
	
	
		\begin{flalign}
		\barG_{i,j}(\barx_{s_0}, \bary_t) \cdot \ddot{\bary}_t^{j} + 
		\barG_{i,kl} (\barx_{s_0}, \bary_t) \cdot \dot{\bary}_t^{k} \cdot \dot{\bary}_t^{l}=0.\\
		\ddot{\bary}_t^{j} = - 
		\barG^{i,j}(\barx_{s_0}, \bary_t) \cdot \barG_{i,kl} (\barx_{s_0}, \bary_t) \cdot \dot{\bary}_t^{k} \cdot \dot{\bary}_t^{l}.
		\end{flalign}
		
		Denote $\Xi_{t} := (\barx_{s_0}, \bary_t)$. For any fixed $t_0 \in [0,1]$, let $P = \dot{\barx}_{s_0} \oplus 0$, $Q = \dot{\Xi}_{t_0} = 0 \oplus \dot{\bary}_{t_0} \in \R^{2n+2}$. Thus from part $\mathrm{(vi)}$, 
		\begin{flalign}
			 \sec_{\Xi_{t_0}}^{(M, g)}P \wedge Q
			 \ge  0.
		\end{flalign}
		On the other hand, with similar calculations as above, one has
		\begin{flalign}
		&\frac{\partial^4}{\partial s^2 \partial t^2} \barG(\barx_s, \bary_t)\Bigg|_{s=s_0, t = t_0} \\
		=\ & [- \barG_{il,\alpha}(\barx_{s_0}, \bary_{t_0})\cdot \barG^{\beta,\alpha}(\barx_{s_0}, \bary_{t_0}) \cdot \barG_{\beta,jk} (\barx_{s_0}, \bary_{t_0}) + \barG_{il,jk}(\barx_{s_0}, \bary_{t_0})]\cdot \dot{\barx}_{s_0}^{i}\cdot\dot{\barx}_{s_0}^{l} \cdot\dot{\bary}_{t_0}^{j} \cdot \dot{\bary}_{t_0}^{k}\\
		= \ & \sec_{\Xi_{t_0}}^{(M, g)}P \wedge Q.
		\end{flalign}
	Therefore, \eqref{barG-4thorder} holds for all $t \in [0,1]$.
\end{proof}



\begin{remark}
	Strict inequality versions of $\mathrm{(v)}$ and $\mathrm{(vi)}$ in Theorem \ref{prop:4thorder2} are equivalent to strict inequality of $\mathrm{(iii)}$, and thus condition $\Gthree_{u}$.
\end{remark}

%
%\begin{remark}
%	Theorem \ref{prop:4thorder2} holds for $w \in \R$ whenever the equation \eqref{barG-4thorder} is replaced by the following:
%	\begin{equation}\label{barG-4thorder2}
%	w_0\frac{\partial^4}{\partial s^2 \partial t^2} \Bigg|_{s=s_0} \barG(\barx_s,\bary_t)  \ge 0,
%	\end{equation}
%	\color{red} need to change the definition of G-segment in Definition \ref{DefGsegment}. And also check the proof again. 
%\end{remark}
